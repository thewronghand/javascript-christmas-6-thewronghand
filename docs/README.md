# 미션 - 크리스마스 프로모션

주어진 요구사항에 맞추어 크리스마스 프로모션 어플리케이션을 구현합니다.

## 🤔 요구사항 리스트

- [x] 사용자로부터 예상 방문 날짜를 숫자로 입력받는다.
- [x] 입력받은 날짜가 유효하지 않을 경우 (예: 숫자가 아닌 값 입력, 양의 정수가 아닌 값 입력, 12월에 존재하지 않는 날짜 입력) 예외를 발생시킨다.
- [x] 예외 발생의 경우 에러 메세지를 표시한 후 다시 입력받는다.
- [x] 사용자로부터 주문할 메뉴를 입력받는다.
  - [x] 메뉴는 `메뉴명 - 갯수` 형식으로 입력하고, `,`를 기준으로 구분한다.
  - [x] 메뉴판에 없는 메뉴를 입력한 경우, 메뉴 갯수 총합이 최대값(20)보다 큰 경우, 음료만 주문한 경우, 메뉴 이름을 중복으로 입력한 경우, 메뉴의 갯수로 유효하지 않은 값이 입력된 경우 예외를 발생시킨다.
  - [x] 예외 발생의 경우 에러 메세지를 표시한 후 다시 입력받는다.
- [x] 입력된 방문 날짜와 메뉴 구성, 주문 금액에 따라 다음과 같은 할인을 적용한다.
  - [x] 크리스마스 디데이 할인 : 1일부터 1000원으로 시작하여 크리스마스에 가까워질 때마다 할인금액 100원 증가 (12/1 : 1000 , 12/2 : 1100 ... 12/25: 3400)
  - [x] 평일 할인 : 평일 (일 ~ 목)에는 디저트 메뉴를 메뉴 1개당 2023원 할인
  - [x] 주말 할인 : 주말에는 메인 메뉴를 메뉴 1개당 2023원 할인
  - [x] 특별 할인 : 이벤트 달력애 별이 있는 날(3, 10, 17, 24, 25, 31)은 총 주문 금액에서 1000원 할인
  - [x] 증정 이벤트: 할인 전 총 주문 금액이 12만원 이상이면 샴페인 (25000원) 1개 증정
  - [x] 크리스마스 디데이 할인을 제외한 이벤트는 12/1 ~ 12/31까지 적용된다.
  - [x] 모든 할인 이벤트는 총 주문 금액이 1만원 이상일 때에만 적용된다.
- [x] 할인 총 혜택 금액에 따라 이벤트 배지를 부여한다.
- [x] 할인이 적용된 결과를 출력한다.
  - [x] 주문 메뉴를 메뉴명과 갯수 별로 출력한다.
  - [x] 할인 전 총 주문 금액을 출력한다.
  - [x] 증정 메뉴를 출력한다. 증정 이벤트에 해당되지 않으면 '없음'을 출력한다.
  - [x] 혜택 내역을 출력한다. 표시는 `적용된 할인명: -(할인금액)원`과 같이 한다. 적용된 혜택이 없으면 '없음' 을 출력한다.
  - [x] 총혜택 금액을 출력한다.
  - [x] 할인 후 예상 결제 금액을 출력한다.
  - [x] 12월 이벤트 배지를 표시한다. 해당 사항이 없을 경우 '없음' 을 출력한다.

## 🧐 실제 구현 사항 리스트

### 🎮 앱 세부 구현 사항

### 🛠 설계 및 구조 변경 사항

- **증정품 가액의 관리** : 증정품 가액은 혜택 금액에는 포함되지만, 실제로 증정품 가액 만큼 구매액에서 할인을 적용해서는 안된다. 기존에는 이를 처리하기 위해 **결과에 증정품을 설정할 때 증정품 가액만큼 총 혜택액을 차감하는** 로직을 적용했으나, **다른 형태로 혜택금액과 할인금액에 차이가 발생할 경우 별도의 처리가 필요**할 것이라 판단해, 확장성을 고려하여 **각 Benefit이 benefitAmount(혜택금액)와 discountAmount(할인금액)를 따로 관리하도록** 구조를 수정했다. 이 경우 할인금액과 혜택금액이 동일해도 상관없는 Benefit에서는 추가적인 연산을 해야 하지만, 증정 할인 이외에도 할인금액과 혜택금액이 일치하지 않는 할인 유형이 추가되더라도 Discounter 등의 외부 객체 로직 수정 없이 적용할 수 있다.

- **혜택 금액을 음수에서 양수로** : 기존에는 혜택금액(+할인금액)을 음수로 관리하여, 출력할 때 별도로 -기호를 붙이지 않아도 되게끔 처리했다. 그러나 혜택금액이 **음수인 것보다 양수인 편이 더 이해하기 쉽다**고 판단했고, 출력 시에만 - 기호를 붙여 출력하면 되므로 **트레이드오프도 크지 않다고 생각**하여 혜택 금액을 음수 대신 양수로 관리하도록 수정했다.

- **할인 조건은 충족하지만 실제 할인이 불가능할 경우의 처리** : 평일, 주말 할인은 **특정 카테고리의 주문 갯수만큼 할인**한다. 요일 조건이 충족되더라도 할인이 적용되는 메뉴가 주문에 포함되지 않은 경우, `평일 할인 : -0원`과 같이 부자연스럽게 출력된다. WeekDayBenefit과 WeekendBenefit에서 isApplied변수를 **benefitAmount가 0보다 큰지**로 동적으로 결정되도록 하여, 실제로 할인이 적용되지 않은 경우에는 isApplied가 false가 되므로 할인 결과가 아예 출력되지 않게 된다.

### 📝 테스트 작성 목록

- [ ] **유닛 테스트**

  - [x] validator 테스트 : 유효성 검사기가 예상대로 동작하는지 검증
    - [x] InputViewValidator 테스트
    - [x] MenuValidator 테스트
    - [x] PromotionServiceValidator 테스트
  - [x] Benefit 테스트 : 각 할인 유형 객체들이 주어진 입력에 예상한 결과를 반환하는지 검증

    - [x] ComplimentaryBenefit 테스트
    - [x] DDayBenefit 테스트 : 경계값(1일, 25일)에 따른 할인 결과, 이벤트 기간이 지난 경우(28일)에 대한 결과 검증
    - [x] SpecialDayBenefit 테스트
    - [x] WeekDayBenefit 테스트 : 적용, 미적용 테스트, 할인조건은 일치하지만 할인 적용이 안되는 경우 검증
    - [x] WeekendBenefit 테스트 : 적용, 미적용 테스트, 할인조건은 일치하지만 할인 적용이 안되는 경우 검증

  - [ ] Discounter 테스트
  - [ ] Menu 테스트
  - [ ] PromotionService 테스트

- [ ] **통합 테스트**
  - [ ] PromotionService - Discounter 통합 테스트
  - [ ] PromotionController - PromotionService - View 통합 테스트
